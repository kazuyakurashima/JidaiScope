# チケット・オーバービュー（000）

## プロジェクト構成

**コードネーム：ChronosEdge（クロノス・エッジ）**

日本史全時代を真比率タイムラインで表現し、ピンチズームで探索できるiOSアプリ。

---

## 全体スケジュール

| Sprint       | 期間     | 目標               | チケット                                    |
| ------------ | -------- | ------------------ | ------------------------------------------- |
| **Sprint 0** | Week 1   | 技術検証           | 001                                         |
| **Sprint 1** | Week 2-3 | コアUI実装         | 010, 020, 030, 040, 050, 060, 070, 180, 190 |
| **Sprint 2** | Week 3-4 | 検索・詳細機能     | 080, 090, 100, 110, 120                     |
| **Sprint 3** | Week 4-5 | ブックマーク・設定 | 130, 140                                    |
| **Sprint 4** | Week 5-6 | 課金・品質         | 150, 160, 170,                              |
| **Sprint 5** | Week 6-7 | リリース準備       | テスト・審査                                |

---

## 依存関係図（マインドマップ表現）

```
ChronosEdge MVP
│
├─ [基盤層] ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
│   ├─ 010: Database Setup
│   │   └─ Era, Event, Person, Reign テーブル定義
│   │
│   ├─ 020: State Management (Zustand Store)
│   │   ├─ timelineStore （ズーム、スクロール位置）
│   │   ├─ searchStore （検索履歴、結果）
│   │   ├─ bookmarkStore （ブックマーク）
│   │   └─ iapStore （課金状態）
│   │
│   └─ 180: Design Tokens & 190: Dark Theme
│       └─ カラー、タイポ、スペーシング定義
│
├─ [タイムライン層] ━━━━━━━━━━━━━━━━━━━━━━━
│   │
│   ├─ 030: Timeline Core (TimelineCanvas)
│   │   ├─ Skia描画基本
│   │   ├─ 時代背景帯
│   │   ├─ イベントマーカー
│   │   └─ [◆依存] 040, 050, 070
│   │
│   ├─ 040: Zoom Manager
│   │   ├─ ズームレベル計算
│   │   ├─ スケール計算
│   │   └─ [◆依存] 030
│   │
│   ├─ 050: LOD Manager (Level of Detail)
│   │   ├─ 表示粒度分岐（L0〜L3）
│   │   ├─ 動的情報フィルタ
│   │   └─ [◆依存] 030, 040
│   │
│   ├─ 060: Era Picker
│   │   ├─ 時代選択UI
│   │   ├─ ジャンプアニメーション
│   │   ├─ 幅比率計算
│   │   └─ [◆依存] 030, 040, 120
│   │
│   ├─ 070: Layer Management
│   │   ├─ 時代レイヤー（常時）
│   │   ├─ 主要事件レイヤー（常時）
│   │   ├─ 天皇レイヤー（制限/全表示）
│   │   ├─ 将軍レイヤー（制限/全表示）
│   │   └─ 人物レイヤー（制限/全表示）
│   │   └─ [◆依存] 030, 150 (IAP)
│   │
│   ├─ 120: Haptics Feedback
│   │   ├─ 時代境界通過
│   │   ├─ LOD切替
│   │   ├─ ズームレベル切替
│   │   └─ [◆依存] 030, 050
│   │
│   └─ 001: Tech Validation (Sprint 0)
│       ├─ Skia + Expo互換性 → 030基盤
│       ├─ ピンチズーム60fps → 040基盤
│       ├─ LOD滑らかさ → 050基盤
│       ├─ 幕末〜明治密集描画 → 030, 050基盤
│       └─ ハプティクス統合 → 120基盤
│
├─ [検索・詳細層] ━━━━━━━━━━━━━━━━━━━━━━━
│   │
│   ├─ 080: Search Feature
│   │   ├─ 西暦/和暦/名称検索ロジック
│   │   ├─ インクリメンタルサーチ
│   │   └─ [◆依存] 010, 020, 030
│   │
│   ├─ 090: Event Detail Screen
│   │   ├─ イベントカード UI
│   │   ├─ 関連人物・事件リンク
│   │   └─ [◆依存] 010, 110, 030
│   │
│   ├─ 100: Person Detail Screen
│   │   ├─ 人物カード UI
│   │   ├─ 在位期間・役職表示
│   │   └─ [◆依存] 010, 090, 030
│   │
│   └─ 110: Source/典拠 Display
│       ├─ SourceBadge UI (10px フォント)
│       ├─ 100件の典拠データ
│       └─ [◆依存] 010, 090
│
├─ [ユーザー機能層] ━━━━━━━━━━━━━━━━━━━━━
│   │
│   ├─ 130: Bookmarks Feature
│   │   ├─ ローカル保存（AsyncStorage）
│   │   ├─ ブックマーク管理UI
│   │   └─ [◆依存] 010, 020
│   │
│   ├─ 140: Settings Screen
│   │   ├─ レイヤー表示切替
│   │   ├─ ハプティクス設定
│   │   ├─ テーマ設定
│   │   └─ [◆依存] 020, 070, 120, 150
│   │
│   ├─ 150: IAP Billing (買い切りPro)
│   │   ├─ StoreKit 2統合
│   │   ├─ 購入・復元フロー
│   │   ├─ Pro解放機能制御
│   │   └─ [◆依存] 020, 070
│   │
│   ├─ 160: Paywall Screen
│   │   ├─ Pro案内UI
│   │   ├─ 購入ボタン
│   │   └─ [◆依存] 150
│   │
│   └─ 170: Onboarding (3ステップ)
│       ├─ ウェルカム画面
│       ├─ ズーム操作チュートリアル
│       ├─ Era Picker紹介
│       └─ [◆依存] 030, 040, 060
```

---

## チケット一覧（実装順序）

### **Phase 0: 技術検証（Sprint 0）**

| #   | チケット              | 説明                                | 優先度 | 推定日数 |
| --- | --------------------- | ----------------------------------- | ------ | -------- |
| 001 | Tech Validation & PoC | Skia/Expo互換性、幕末〜明治密集検証 | **P0** | 5d       |

---

### **Phase 1: 基盤構築（Sprint 1）**

| #   | チケット         | 説明                             | 優先度 | 推定日数 | 依存          |
| --- | ---------------- | -------------------------------- | ------ | -------- | ------------- |
| 010 | Database Setup   | SQLite、スキーマ設計、初期データ | **P0** | 2d       | -             |
| 020 | State Management | Zustand store 全体構築           | **P0** | 1.5d     | -             |
| 180 | Design Tokens    | カラー、タイポ、スペーシング     | **P0** | 1d       | -             |
| 190 | Dark Theme       | ダークテーマ実装、テーマ切替     | **P0** | 1d       | 180           |
| 030 | Timeline Core    | TimelineCanvas基本、Skia描画     | **P0** | 3d       | 010, 020, 180 |
| 040 | Zoom Manager     | ズーム計算ロジック               | **P0** | 1.5d     | 030           |
| 050 | LOD Manager      | L0〜L3切替ロジック               | **P0** | 1.5d     | 030, 040      |
| 060 | Era Picker       | 時代ジャンプUI、アニメーション   | **P0** | 1.5d     | 030, 040      |
| 070 | Layer Management | レイヤー表示ロジック、UI         | **P0** | 2d       | 030           |
| 120 | Haptics Feedback | ハプティクス統合、設定制御       | **P1** | 1d       | 030, 050      |

---

### **Phase 2: 検索・詳細機能（Sprint 2）**

| #   | チケット             | 説明                                     | 優先度 | 推定日数 | 依存          |
| --- | -------------------- | ---------------------------------------- | ------ | -------- | ------------- |
| 080 | Search Feature       | 検索ロジック、UI、インクリメンタルサーチ | **P0** | 2d       | 010, 020, 030 |
| 090 | Event Detail Screen  | イベント詳細画面、カード UI              | **P0** | 1.5d     | 010, 030      |
| 100 | Person Detail Screen | 人物詳細画面、カード UI                  | **P0** | 1.5d     | 010, 090      |
| 110 | Source/典拠 Display  | SourceBadge実装、100件典拠データ         | **P1** | 1.5d     | 010, 090      |

---

### **Phase 3: ユーザー機能（Sprint 3）**

| #   | チケット          | 説明                                          | 優先度 | 推定日数 | 依存               |
| --- | ----------------- | --------------------------------------------- | ------ | -------- | ------------------ |
| 130 | Bookmarks Feature | ブックマーク保存・管理・表示                  | **P1** | 1d       | 010, 020           |
| 140 | Settings Screen   | 全設定画面（レイヤー、ハプティクス、IAP復元） | **P1** | 1.5d     | 020, 070, 120, 150 |

---

### **Phase 4: 課金・品質（Sprint 4）**

| #   | チケット       | 説明                       | 優先度 | 推定日数 | 依存          |
| --- | -------------- | -------------------------- | ------ | -------- | ------------- |
| 150 | IAP Billing    | StoreKit 2実装、購入・復元 | **P0** | 2d       | 020           |
| 160 | Paywall Screen | Paywall UI、購入ボタン     | **P0** | 1d       | 150           |
| 170 | Onboarding     | 3ステップチュートリアル    | **P1** | 1.5d     | 030, 040, 060 |

---

## 並行開発ガイドライン

### **Claude Code での作業分担**

各チケットは **独立性を最大化** しています：

1. **基盤層** (010, 020, 180, 190) → 1〜2日で完了後、他チケットをアンブロック
2. **タイムライン層** (030, 040, 050, 060, 070, 120) → 基盤完了後に並行開発可
3. **検索・詳細層** (080, 090, 100, 110) → 独立して並行開発可（Database完了後）
4. **ユーザー機能層** (130, 140) → 独立して並行開発可
5. **課金・品質層** (150, 160, 170) → 独立して並行開発可

### **チケット作業時の確認事項**

各チケットファイルで以下の順序で進めてください：

```
1. 📋 概要セクション確認
2. ✅ 受け入れ条件確認
3. 🔗 依存関係確認（ブロック状態？）
4. 📝 Todo リスト確認・更新
5. 🛠️ 実装ガイドラインに従い実装
6. ✓ 各 Todo を完了マーク
7. 🧪 テスト項目クリア
8. ✅ チケット完了 → 親チケット(概要)を更新
```

### **クロスチケット依存時の連携**

例）チケット 030 (Timeline Core) が完了した際：

- チケット 040, 050, 060, 070, 120 の `依存関係` セクションで確認
- 各チケットのブロック状態を解除
- 親チケット (000) の「完了済みチケット」セクション更新

---

## チケット進捗状況

### **Sprint 0: 技術検証**

- [ ] [001-tech-validation.md](001-tech-validation.md) - Tech Validation & PoC

### **Sprint 1: 基盤構築**

- [ ] [010-database-setup.md](010-database-setup.md) - Database Setup
- [ ] [020-state-management.md](020-state-management.md) - State Management
- [ ] [180/190-design-theme.md](090-110-120-130-140-150-160-170-180-190.md#180) - Design Tokens & Dark Theme
- [ ] [030-timeline-core.md](030-timeline-core.md) - Timeline Core
- [ ] [040-zoom-manager.md](040-zoom-manager.md) - Zoom Manager
- [ ] [050-lod-manager.md](050-lod-manager.md) - LOD Manager
- [ ] [060-era-picker.md](060-era-picker.md) - Era Picker
- [ ] [070-layer-management.md](070-layer-management.md) - Layer Management
- [ ] [120-haptics.md](090-110-120-130-140-150-160-170-180-190.md#120) - Haptics Feedback

### **Sprint 2: 検索・詳細機能**

- [ ] [080-search-feature.md](080-search-feature.md) - Search Feature
- [ ] [090/100/110.md](090-110-120-130-140-150-160-170-180-190.md#090) - Event Detail, Person Detail, Source Display

### **Sprint 3: ユーザー機能**

- [ ] [130/140.md](090-110-120-130-140-150-160-170-180-190.md#130) - Bookmarks, Settings

### **Sprint 4: 課金・品質**

- [ ] [150/160/170.md](090-110-120-130-140-150-160-170-180-190.md#150) - IAP, Paywall, Onboarding
- [ ] 170: Onboarding

---

## 完了済みチケット

_このセクションはチケット完了時に更新されます_

---

## 開発環境・ツール

### **技術スタック**

```
フレームワーク: Expo SDK 51+
描画: @shopify/react-native-skia
ジェスチャー: react-native-gesture-handler
アニメーション: react-native-reanimated
状態管理: Zustand
DB: expo-sqlite
課金: react-native-iap
ハプティクス: expo-haptics
```

### **開発ワークフロー**

```
main (本体)
├─ sprint/1/base
├─ sprint/1/timeline
├─ sprint/2/search
├─ sprint/3/user-features
├─ sprint/4/billing
└─ dev (統合ブランチ)
```

---

## 注意事項

### **Sprint 0 の重要性**

- **幕末〜明治の密集描画** は MVP の成否を左右する最重要検証項目
- 50件/10年の密度でも可読性が維持される必要あり
- 失敗時の対応：LODルール見直し、v1.0でLog/Focusモード前倒し

### **パフォーマンス基準**

- フレームレート: **60fps（主要デバイス）**
- 起動時間: **2秒以内**
- メモリ: **200MB以下**

### **オフライン対応**

- すべてのコア機能（タイムライン、検索、ブックマーク）はオフライン動作必須
- 課金復元のみオンライン要求

---

## 次のステップ

1. ✅ チケットオーバービュー確認（このドキュメント）
2. 📋 各チケット詳細ドキュメント確認
3. 🚀 Sprint 0 開始: チケット 001 で技術検証
4. 🔄 基盤完了後、並行開発開始

---

**最終更新:** 2025-01-25
**バージョン:** 1.0
